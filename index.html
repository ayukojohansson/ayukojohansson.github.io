<html>
  <head>
    <style>
      body {
        text-align : center;
      }
      canvas {
        display : block;
        width : 1100px;
        height : 800px;
        margin : auto;
        padding : 0;
        border : none;
        background-color : black;
      }
      button {
        display : inline-block;
        font-size : inherit;
        margin : auto;
        padding : 0.6em;
      }
    </style>
    <script>
const data = `1587,281
915,921
494,919
2174,1161
2195,41
2509,361
2256,439
1331,599
1357,599
1693,119
995,759
1781,479
1781,801
570,839
2119,721
1913,721
2668,1201
1324,1201
356,1039
944,281
944,359
1197,1199
398,1279
946,1
2290,641
1406,399
1406,881
734,1039
866,1239
1317,401
1400,919
449,481
449,799
2239,799
223,801
1566,1279
2466,639
1794,1
222,961
1122,321
1566,959
2214,839
893,881
2131,1199
2153,439
1817,759
1436,682
2108,598
2679,598
2025,598
1525,522
1525,758
70,562
1414,718
1946,82
742,1198
1274,402
1076,82
1193,958
1495,958
1361,82
1322,82
2245,602
229,358
1115,358
1115,1082
2545,118
2159,758
1906,402
260,357
1604,923
9,283
2679,283
1857,837
1839,1157
2258,963
1774,963
2615,837
241,1237
2447,1237
264,77
2424,77
264,1203
2280,77
517,363
433,363
2255,363
98,877
2114,237
2114,1043
770,237
1918,237
1780,677
1327,1003
2335,683
991,523
1406,557
734,877
1742,557
946,723
946,843
947,923
1369,1157
2663,197
2410,1277
1066,1277
278,643
2360,724
1083,884
769,316
490,1196
1834,236
1834,1044
2590,84
1582,84
740,436
1948,844
739,764
1411,1084
1747,596
190,836
1153,924
563,604
226,396
2074,364
1016,565
916,85
1772,85
1772,1195
513,885
1857,395
1693,125
1022,285
2366,355
1663,915
1781,995
437,355
402,285
2622,515
2035,1035
736,1245
2416,675
400,915
2288,915
944,915
776,845
1912,845
2163,925
1490,915
1622,565
950,75
1738,75
531,805
2493,565
2493,715
1065,275
2631,435
447,205
476,675
2156,835
2549,565
2549,715
1877,565
197,405
1987,365
894,155
641,355
2657,765
557,115
2131,115
1901,1165
1176,1232
589,368
2099,368
589,912
2099,912
2603,48
1259,48
2603,592
1931,688
2606,32
590,608
2098,608
2098,672
2270,352
926,768
1683,1088
2272,848
1601,1008
2273,368
831,672
849,352
1839,352
850,632
1838,632
850,648
2362,1192
1775,792
2593,552
660,248
1020,232
1020,872
576,232
240,1192
2171,1048
1496,688
1865,872
1193,128
1193,1152
185,1152
185,768
2503,768
2201,192
1663,112
1663,1168
1663,752
1198,928
482,992
2206,992
1741,808
2490,1232
870,688
283,888
2469,528
2235,1168
891,752
2234,248
218,552
2234,1192
454,552
133,632
1968,832
1800,128
1800,1152
2232,832
1885,688
2557,752
2557,1072
131,432
2557,432
1130,632
336,911
2352,911
2351,111
1007,529
1681,529
1007,751
331,969
2347,969
2190,871
2276,391
2276,889
2427,1151
2427,191
2427,449
2617,409
2450,1191
2254,1049
910,1049
1778,1049
910,409
101,1009
1445,911
571,1009
1579,49
437,689
2251,689
2453,751
2251,1169
1242,231
1446,409
2250,1049
1659,1031
315,391
2373,391
2038,609
862,991
482,929
398,689
1483,431
138,1151
450,129
2238,129
2238,1151
894,1151
2635,751
2566,409
122,871
207,151
1137,151
2481,489
465,1129
879,791
1809,809
2391,871
1803,1231
2229,591
2016,850
1848,690
2185,1090
1087,1110
2431,810
2610,110
1422,110
1422,1170
1604,590
2276,50
2427,130
1419,1010
2091,270
1437,850
598,910
1669,70
2363,710
240,1250
1584,1250
2533,1230
2449,1070
1583,1070
239,430
1414,90
1274,1190
1750,730
602,690
234,690
1782,1230
1241,490
1447,490
1111,1110
1577,1110
439,170
2249,170
1196,1230
148,590
2540,590
820,690
2204,370
651,630
2037,630
1869,490
1533,170
1155,470
1533,470
2415,1210
1071,1210
2658,370
1314,370
1374,370
1314,910
1374,910
702,910
1290,290
1398,290
2130,510
1627,390
977,350
2657,1150
1375,130
1313,770
641,1150
1985,130
703,770
1126,350
1295,1150
721,1090
217,610
1799,670
1393,1230
2065,850
1800,150
888,1130
2221,350
2221,930
205,190
2650,790
1726,1110
2184,29
2184,1251
168,131
840,771
2016,1011
2016,909
587,291
2101,291
587,989
1259,829
2105,509
918,1149
1770,189
2262,829
1168,749
1437,269
323,371
1021,371
1667,909
1835,531
2618,611
2618,669
2114,509
1615,691
401,211
943,429
1745,429
943,851
1700,331
988,931
474,1251
137,251
2551,251
893,1171
893,749
122,509
2566,509
122,771
213,91
885,731
756,692
1428,1012
1009,708
1007,892
1681,892
503,908
2186,1212
333,172
2355,1108
332,548
332,732
2348,548
2600,812
1768,1132
1423,188
1265,1092
425,28
247,508
2441,508
2441,772
1184,668
1504,668
176,1252
2512,612
831,892
2193,388
159,428
1357,732
685,1052
1499,732
98,332
2590,948
910,332
1358,428
2333,1092
859,508
1829,508
859,772
2456,412
440,228
2248,1052
1062,172
2551,92
1481,92
1817,868
1881,172
807,1108
2151,468
1881,708
1545,892
471,868
470,852
1814,428
2569,748
1463,532
1225,748
1463,748
1476,12
467,708
2221,708
1886,268
466,588
1222,932
2440,145
1096,785
2264,785
2440,815
752,255
2263,575
258,1225
1015,985
1336,855
1352,855
1688,535
2108,695
764,585
2511,815
2171,1025
853,575
1442,305
98,1105
770,465
99,1095
1245,825
1107,505
1581,505
2620,1255
940,185
487,1055
403,255
522,1185
2166,1185
1158,505
2202,505
150,105
858,105
2457,135
1113,265
442,25
2246,295
1786,295
2246,345
863,215
948,505
1487,185
1873,455
1874,25
530,615
702,255
1566,135
2238,505
558,215
1902,425
2489,705
535,545
1755,776
429,136
2259,136
765,744
2110,1176
430,856
2028,664
2004,616
1609,256
239,936
2449,936
2255,936
1583,104
1583,1176
2084,104
2452,1016
236,904
1108,904
185,224
354,776
2334,776
990,776
1027,1264
1661,336
2455,1104
1150,544
2631,1264
1401,656
1737,1264
561,496
2127,784
1483,424
533,216
1877,216
785,936
2550,776
534,456
893,424
893,856
1795,856
2105,1177
1254,257
1434,257
2429,663
596,97
1773,217
1836,177
600,143
1331,57
1357,57
995,57
1359,137
1779,343
909,937
1779,937
1612,543
1580,383
1108,897
150,857
522,217
2622,1177
1278,1177
1410,743
1110,537
1110,743
1578,743
234,857
1782,857
2585,417
1577,543
439,1183
1577,417
1658,97
2374,417
1535,903
1825,1177
1704,903
2495,103
1537,1177
1789,823
110,897
618,1257
726,663
1375,543
641,97
641,1183
1985,543
871,417
2356,298
332,982
1676,982
2599,58
89,1222
1255,1222
1433,1222
2105,58
2105,378
1272,578
1416,578
1163,22
491,618
1835,342
1106,818
2450,1022
1834,538
2337,418
993,418
270,298
1614,938
1699,382
1785,458
2666,258
1366,1022
650,898
2634,978
114,1218
1039,498
1039,782
2551,382
893,1222
2104,1019
1928,1179
2095,1221
1769,1221
1591,741
78,539
1266,219
161,821
1756,619
2529,1059
578,1221
2110,1221
2446,741
1021,1261
182,99
2506,1181
490,1181
2198,1181
1834,99
2337,61
405,739
100,501
100,779
2588,779
908,1141
2620,1061
2620,421
151,861
1495,419
1830,61
2454,221
1578,1059
234,419
2454,419
861,499
1282,1261
1406,1261
1282,659
1909,19
276,1181
1068,1181
1151,181
1537,181
1151,1099
479,219
1874,659
2494,1139
2210,141
2210,499
1454,461
1234,259
1234,381
561,1139
561,781
366,1181
557,1219
1565,61
221,701

x,1344
y,640
x,672
y,320
x,336
y,160
x,168
y,80
x,84
y,40
x,42
y,20`;

const [lines, folds] = data.split('\n\n');
const instructions = folds.split('\n').map(line => {
  const [dir, value] = line.split(',');
  return [dir=='x' ? +value : 0, dir=='y' ? +value : 0];
});

      (function(){
        "use strict"

        const { dots } = lines.split('\n').reduce((acc, line) => {
          const [x,y] = line.split(',').map(d => +d);
          acc.dots.push(new Rectangle(x,y));
          if (!acc.maxX || acc.maxX < x) acc.maxX = x;
          if (!acc.maxY || acc.maxY < y) acc.maxY = y;
          return acc;
        }, { dots: [] });

        window.addEventListener("load", setupAnimation, false);
        let canvas, ctx, 
          timer,
          display;

        function setupAnimation (evt) {
          canvas = document.querySelector("canvas");
          ctx = canvas.getContext('2d');
          ctx.fillStyle = 'fuchsia';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          console.log(canvas.width, canvas.height)
          display = document.querySelector("strong");
          window.removeEventListener(evt.type, setupAnimation, false);

          drawAnimation();
        }

        function scissor (x, y, f) {
          ctx.fillStyle = 'fuchsia';
          ctx.fillRect(x*f + 20, y*f + 20, 10 , 10);
        }
        function clear () {
          ctx.fillStyle = 'black';
          ctx.fillRect(0,0,1100,800);
        }

        let step = 0;
        let maxX = 0, maxY = 0;
        let factor;
        function updateNextPosition () {
          const instruction = instructions[step];
          if (!instruction) {
            console.log('done!');
            return;
          }

          maxX = 0;
          maxY = 0;
          dots.forEach(rect => {
            if (maxX < rect.position[0]) maxX = rect.position[0];
            if (maxY < rect.position[1]) maxY = rect.position[1];
            rect.next = [
              (instruction[0] && rect.position[0] > instruction[0]) ? instruction[0] * 2 - rect.position[0] : rect.position[0],
              (instruction[1] && rect.position[1] > instruction[1]) ? instruction[1] * 2 - rect.position[1] : rect.position[1]
            ];
            rect.move = [rect.position[0] - rect.next[0], rect.position[1] - rect.next[1]];
          })

          const nextFactor = Math.min(750 / maxY, 1000 / maxX);
          if (!factor) factor = nextFactor;
          scaleAnimation(factor, nextFactor, (nextFactor-factor) / 10);

          display.innerHTML = `${step + 1}`;
        }

        function scaleAnimation (current, nextFactor, increase) {
          if (!factor) return;

          if (current >= nextFactor) {
            factor = nextFactor;
            timer = setTimeout(drawAnimation, 300);
          } else {
            clear();
            dots.forEach(rect => {
              scissor(rect.position[0], rect.position[1], current);
            });
            timer = setTimeout(() => scaleAnimation(current + increase, nextFactor, increase), 30);
          }
        }

        function drawAnimation () {
          const size = 10;
          const speed = 20/factor;
          let moved = false;
          clear();
          dots.forEach(rect => {
            if (rect.move[0] > 0) {
              scissor(rect.next[0] + rect.move[0], rect.position[1], factor);
              rect.move[0] -= speed;
              moved = true;
            } else if (rect.move[1] > 0) {
              scissor(rect.position[0], rect.next[1] + rect.move[1], factor);
              rect.move[1] -= speed;
              moved = true;
            } else if (rect.next) {
              rect.position = rect.next;
              scissor(rect.position[0], rect.position[1], factor);
            }
          });

          if (moved) {
            timer = setTimeout(drawAnimation, 30);
          } else {
            updateNextPosition();
            step++;
          }
        }

        function Rectangle (x, y) {
          var rect = this;
          rect.position = [x, y];  
          rect.move = [0, 0];  
        }
      })();
    </script>
  </head>
  <body>
    <p>Folding <strong>0</strong> times</p>
    <canvas width="1100" height="800">Your browser does not seem to support 
      HTML5 canvas.</canvas>
  </body>
</html>